# 📝 更新日志

Nav-data 的所有重要变更都记录在这个文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
项目遵循 [语义化版本控制](https://semver.org/lang/zh-CN/)。

## [未发布] - 即将推出

### 🚀 新增

- 新的可视化数据验证报告
- 支持多线程数据库写入优化
- 增加数据处理进度监控

### 🔧 改进

- 优化内存使用，支持更大的数据集
- 改进错误消息的可读性
- 增强配置文件验证

### 🐛 修复

- 修复特殊字符在机场名称中的处理问题
- 解决并发处理时的数据竞争问题

---

## [2.1.0] - 2024-12-24

### 🚀 新增功能

- **智能航路合并算法** - 实现了高级的航路数据合并逻辑，支持自动检测公共航路点并智能插入缺失航段
- **数据库验证工具** - 添加了 `db_validator.py`，提供全面的数据库完整性检查和质量报告
- **并发处理支持** - 多线程处理大型数据集，显著提升处理速度
- **磁差计算集成** - 集成 pygeomag 库，提供精确的磁偏角计算
- **进度监控** - 添加了 tqdm 进度条，实时显示处理进度

### 🔧 改进优化

- **内存管理优化** - 实现批处理机制，大幅降低内存占用
- **坐标转换精度** - 提升 DMS 到十进制度的转换精度至8位小数
- **错误处理增强** - 更详细的错误日志和异常处理机制
- **数据验证加强** - 增加了坐标范围验证和 ICAO 代码格式检查
- **代码模块化** - 重构代码结构，提高可维护性

### 🐛 问题修复

- 修复了 CSV 文件编码检测问题，正确处理 Latin-1 编码
- 解决了重复记录导致的数据库约束冲突
- 修复了航路点坐标精度丢失问题
- 解决了大文件处理时的内存溢出问题
- 修复了 Windows 路径分隔符兼容性问题

### 📚 文档更新

- 完全重写了技术文档，包含详细的架构说明
- 添加了完整的安装和配置指南
- 新增了故障排除和 FAQ 部分
- 更新了 API 文档和代码示例

### 🔒 安全性改进

- 添加了输入路径验证，防止路径遍历攻击
- 增强了 SQL 输入清理机制
- 改进了文件权限检查

---

## [2.0.0] - 2024-11-15

### 🚀 重大更新

- **完全重构的数据处理引擎** - 从头设计的模块化架构
- **PMDG 777 支持** - 扩展支持 PMDG 777-300ER 和 777F
- **新的数据库架构** - 优化的表结构，更好的性能和兼容性
- **中国地区数据专项支持** - 针对中国民航数据进行特别优化

### 🔧 技术改进

- **Python 3.8+ 支持** - 更新到现代 Python 版本
- **类型注解** - 全面添加类型提示，提高代码质量
- **异步处理** - 引入异步数据处理能力
- **配置管理** - 新的配置系统，支持 YAML 配置文件

### 📊 数据处理增强

- **多源数据集成** - 支持 NAIP、X-Plane、CIFP 多种数据源
- **坐标系统统一** - 标准化的坐标转换和验证
- **数据质量保证** - 完整的数据验证和清理流程

### 🛠️ 工具改进

- **命令行界面优化** - 更友好的 CLI 工具
- **批处理支持** - 支持批量处理多个数据文件
- **日志系统升级** - 结构化日志，更好的调试支持

### 💔 破坏性变更

- **最低 Python 版本要求** - 需要 Python 3.8 或更高版本
- **配置文件格式变更** - 新的 YAML 配置格式
- **API 接口重构** - 部分函数和类的接口发生变化
- **依赖项更新** - 更新了多个核心依赖包

### 🗑️ 移除功能

- 移除了对 Python 2.7 的支持
- 删除了过时的 XML 配置格式支持
- 移除了实验性的网络数据源功能

---

## [1.5.2] - 2024-10-10

### 🐛 修复

- 修复 AIRAC 2410 数据兼容性问题
- 解决 PMDG 737-900 数据库路径问题
- 修复日志文件编码问题

### 🔧 改进

- 优化数据库连接池管理
- 改进错误消息的中文显示
- 更新了机场名称查找数据库

---

## [1.5.1] - 2024-09-28

### 🐛 修复

- 修复 MSFS Steam 版本路径检测
- 解决跑道方向计算精度问题
- 修复特殊字符导致的 CSV 解析错误

### 📚 文档

- 更新安装指南中的 MSFS 路径说明
- 添加常见问题的解决方案

---

## [1.5.0] - 2024-09-15

### 🚀 新增

- **AIRAC 2409 支持** - 支持最新的航空信息法规周期
- **跑道数据增强** - 添加跑道表面类型和坡度信息
- **自动备份功能** - 自动备份原有导航数据
- **数据验证报告** - 生成详细的数据处理报告

### 🔧 改进

- 提升大型机场数据处理速度
- 优化内存使用效率
- 改进用户界面的反馈信息

### 🐛 修复

- 修复高海拔机场高程数据错误
- 解决某些特殊机场 ICAO 代码处理问题
- 修复跑道长度单位转换错误

---

## [1.4.1] - 2024-08-20

### 🐛 修复

- 修复 Windows 11 兼容性问题
- 解决数据库锁定问题
- 修复中文路径处理错误

### 🔧 改进

- 提升启动速度
- 优化错误提示信息

---

## [1.4.0] - 2024-08-05

### 🚀 新增

- **多语言支持基础** - 添加国际化框架
- **数据导出功能** - 支持导出为多种格式
- **性能监控** - 添加处理性能统计

### 🔧 改进

- **数据库优化** - 重新设计索引结构，查询速度提升 40%
- **内存管理** - 减少内存占用 30%
- **用户体验** - 改进错误提示和状态显示

### 🐛 修复

- 修复航路点重复问题
- 解决 ILS 频率精度问题
- 修复时区处理错误

---

## [1.3.2] - 2024-07-12

### 🐛 修复

- 修复 PMDG 737 MAX 系列兼容性
- 解决夏令时对 AIRAC 日期的影响
- 修复某些导航设备频率显示问题

---

## [1.3.1] - 2024-06-28

### 🐛 修复

- 修复 macOS 路径处理问题
- 解决 CSV 文件 BOM 标记问题
- 修复航路连接验证错误

### 🔧 改进

- 提升文件读取速度
- 优化日志输出格式

---

## [1.3.0] - 2024-06-15

### 🚀 新增

- **Linux 支持** - 扩展对 Linux 系统的支持
- **配置验证** - 添加配置文件语法检查
- **数据统计** - 生成详细的数据处理统计信息

### 🔧 改进

- **跨平台兼容性** - 统一不同操作系统的行为
- **错误恢复** - 增强数据处理的容错能力
- **代码质量** - 重构核心模块，提高代码质量

### 🐛 修复

- 修复非 ASCII 字符处理问题
- 解决大文件处理超时问题
- 修复数据库事务处理错误

---

## [1.2.1] - 2024-05-20

### 🐛 修复

- 修复 AIRAC 日期计算错误
- 解决某些机场坐标转换问题
- 修复进度显示不准确的问题

---

## [1.2.0] - 2024-05-05

### 🚀 新增

- **AIRAC 2405 支持** - 支持最新导航数据周期
- **批处理模式** - 支持处理多个数据文件
- **数据差异检测** - 比较不同版本数据的差异

### 🔧 改进

- **处理速度** - 数据处理速度提升 25%
- **内存优化** - 优化大数据集的内存使用
- **日志详细程度** - 提供更详细的处理日志

### 🐛 修复

- 修复航路高度限制处理
- 解决 VOR/DME 频率重复问题
- 修复机场标高数据精度

---

## [1.1.2] - 2024-04-18

### 🐛 修复

- 修复 Windows 长路径支持问题
- 解决特殊字符编码错误
- 修复数据库连接超时问题

---

## [1.1.1] - 2024-04-05

### 🐛 修复

- 修复 PMDG 737-800 数据库路径问题
- 解决 ILS 下滑道角度计算错误
- 修复某些航路点缺失问题

### 📚 文档

- 更新安装指南
- 添加故障排除章节

---

## [1.1.0] - 2024-03-22

### 🚀 新增

- **STAR 程序支持** - 添加标准终端到达程序处理
- **进近程序** - 支持仪表进近程序数据
- **数据验证增强** - 更严格的数据完整性检查

### 🔧 改进

- **SID 程序优化** - 改进标准仪表离场程序处理
- **坐标精度** - 提高坐标计算精度
- **错误处理** - 更好的错误信息和恢复机制

### 🐛 修复

- 修复 NDB 频率范围验证
- 解决航路连接断开问题
- 修复跑道磁方位计算

---

## [1.0.0] - 2024-03-01

### 🎉 首次正式发布

#### 🚀 核心功能

- **PMDG 737 系列完整支持** - 支持所有 PMDG 737 变体
- **完整的导航数据转换** - 机场、跑道、导航设备、航路数据
- **中国地区优化** - 专门针对中国民航数据进行优化
- **AIRAC 2403 支持** - 支持 2024 年 3 月航空信息周期

#### 🛠️ 技术特性

- **SQLite 数据库** - PMDG 兼容的数据库格式
- **多源数据支持** - 支持 NAIP 和 X-Plane 数据源
- **自动化处理** - 一键式数据转换流程
- **数据验证** - 完整的数据质量检查

#### 📊 支持的数据类型

- 机场基础信息 (ICAO 代码、坐标、名称)
- 跑道数据 (长度、宽度、方向、表面)
- VOR/DME 导航设备
- NDB 导航信标
- 航路点和航路网络
- ILS 仪表着陆系统

#### 🎯 支持的飞机

- PMDG 737-600
- PMDG 737-700
- PMDG 737-800
- PMDG 737-900

#### 🌍 支持的地区

- 中国大陆 (ICAO 代码 ZB, ZG, ZS, ZJ, ZY, ZL, ZH, ZU, ZP, ZW)

---

## 版本规划

### 🔮 未来版本计划

#### v2.2.0 (计划 2025 Q1)

- **iniBuilds 飞机支持** - 扩展支持 iniBuilds 系列飞机
- **实时数据更新** - 支持在线 AIRAC 数据更新
- **图形用户界面** - 添加桌面 GUI 应用
- **云端数据源** - 支持云端数据源集成

#### v2.3.0 (计划 2025 Q2)

- **全球数据支持** - 扩展到全球范围的导航数据
- **自定义插件系统** - 支持第三方插件开发
- **数据分析工具** - 内置数据分析和可视化
- **REST API** - 提供 Web API 接口

#### v3.0.0 (计划 2025 Q4)

- **下一代架构** - 基于微服务的分布式架构
- **机器学习优化** - 智能数据处理和优化
- **多模拟器支持** - 支持 P3D、FSX 等其他模拟器
- **企业级功能** - 高可用性、负载均衡等企业功能

---

## 📋 更新说明

### 🔖 版本号规则

我们使用语义化版本控制 (SemVer)：

- **主版本号** (X.y.z) - 不兼容的 API 修改
- **次版本号** (x.Y.z) - 向下兼容的功能新增
- **修订号** (x.y.Z) - 向下兼容的问题修正

### 🏷️ 变更类型说明

- **🚀 新增 (Added)** - 新功能
- **🔧 改进 (Changed)** - 已有功能的修改
- **🗑️ 弃用 (Deprecated)** - 即将移除的功能
- **🗑️ 移除 (Removed)** - 已移除的功能
- **🐛 修复 (Fixed)** - 问题修复
- **🔒 安全 (Security)** - 安全性相关修复

### 📅 发布周期

- **主版本** - 每年 1-2 次重大更新
- **次版本** - 每季度功能更新
- **修订版本** - 根据需要发布 bug 修复

### 🔗 获取更新

- **GitHub Releases** - 获取最新版本和详细变更日志
- **自动通知** - 订阅发布通知以获取第一时间更新
- **Beta 测试** - 参与 Beta 测试计划体验新功能

---

**注意**: 如需查看特定版本的详细变更，请访问 [GitHub Releases](https://github.com/Nav-data/releases) 页面。
